= Automate nexus configuration with scripting API

== Openshift

This example has been tested with link:https://github.com/minishift/minishift[Minishift].

To start a new Openshift instance:

[source,shell]
----
minishift config set cpus 4
minishift config set memory 4GB
minishift start --openshift-version 3.6.0
----

=== Nexus 3 deployment

[source,shell]
----
oc new-app sonatype/nexus3
# https://github.com/OpenShiftDemos/nexus/issues/6
oc env dc/nexus3 INSTALL4J_ADD_VM_PARAMS="-Xms1024m -Xmx1024m -Djava.util.prefs.userRoot=/nexus-data/"
oc expose svc/nexus3

#probe
oc set probe dc/nexus3 \
	--liveness \
	--failure-threshold 3 \
	--initial-delay-seconds 30 \
	-- echo ok
oc set probe dc/nexus \
	--readiness \
	--failure-threshold 3 \
	--initial-delay-seconds 30 \
	--get-url=http://:8081/nexus/content/groups/public

#volume
oc volumes dc/nexus3 --add \
	--name 'nexus3-volume-1' \
	--type 'pvc' \
	--mount-path '/nexus-data/' \
	--claim-name 'nexus3-pv' \
	--claim-size '10G' \
	--overwrite
----